<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gerador de QR Code</title>
  <!-- Link para o arquivo CSS com versão para evitar cache -->
  <link rel="stylesheet" th:href="@{/css/style.css?v=1}" />
</head>
<body>
<div class="container">
  <h1>Gerador de QR Code</h1>
  <p class="subtitle">Insira um texto ou URL e gere seu QR Code personalizado.</p>

  <!-- Formulário para gerar o QR Code -->
  <form th:action="@{/generate}" method="get" id="qrForm">
    <div class="input-group">
      <label for="text">Conteúdo do QRCode</label>
      <input type="text" id="text" name="text" placeholder="Digite o texto ou URL" required />
    </div>
    <div class="input-group">
      <label for="width">Tamanho (px)</label>
      <input type="number" id="width" name="width" value="250" min="100" max="500" required />
    </div>
    <button type="submit">Gerar QR Code</button>
  </form>

  <!-- Seção de resultado com o QR Code gerado -->
  <div id="qrCodeResult" class="hidden">
    <h2>Resultado</h2>
    <img id="qrImage" th:src="@{/generate(text=${text}, width=${width}, height=${width})}" alt="QR Code Gerado" />
    <a id="downloadBtn" class="download-btn" th:href="@{/generate(text=${text}, width=${width}, height=${width})}" download="qrcode.png">Baixar QR Code</a>
  </div>

  <!-- Footer com informações do autor -->
  <footer>
    <p>© 2025 Mateus | Projeto de Estudo</p>
  </footer>
</div>

<!-- Script para atualizar dinamicamente o QR Code e o botão de download -->
<script th:inline="javascript">
  document.getElementById('qrForm').addEventListener('submit', function(event) {
      event.preventDefault();
      const text = document.getElementById('text').value;
      const width = document.getElementById('width').value;
      fetch(`/generate?text=${encodeURIComponent(text)}&width=${width}&height=${width}`)
          .then(response => response.blob())
          .then(blob => {
              const url = URL.createObjectURL(blob);
              document.getElementById('qrImage').src = url;
              document.getElementById('downloadBtn').href = url;
              document.getElementById('qrCodeResult').classList.remove('hidden');
          });
  });
</script>
</body>
</html>